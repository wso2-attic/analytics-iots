<domain name="SensorDataAnalyticsDomain">
    <description>Domain for sensor data analysis</description>
    <scenarios>
        <scenario type="SensorAnalytics">
            <description>Configure a sensor analytics scenario to display statistics for a given stream of your choice</description>
            <templates>
                <!--Note: These will be deployed in the order they appear here-->
                <template type="eventstream">
                    {
                    "name": "org.wso2.event.${toId('$sensorType')}.stream",
                    "version": "1.0.0",
                    "nickName": "",
                    "description": "",
                    "payloadData": [
                    {
                    "name": "sensor_id",
                    "type": "STRING"
                    },
                    {
                    "name": "sensor_value",
                    "type": "DOUBLE"
                    }
                    ]
                    }
                </template>
                <template type="eventstream">
                    {
                    "name": "org.wso2.event.${toId('$sensorType')}.statistics.stream",
                    "version": "1.0.0",
                    "nickName": "",
                    "description": "",
                    "payloadData": [
                    {
                    "name": "sensor_type",
                    "type": "STRING"
                    },
                    {
                    "name": "sensor_id_distinct_count",
                    "type": "LONG"
                    },
                    {
                    "name": "count",
                    "type": "LONG"
                    },
                    {
                    "name": "sum",
                    "type": "DOUBLE"
                    },
                    {
                    "name": "average",
                    "type": "DOUBLE"
                    },
                    {
                    "name": "max",
                    "type": "DOUBLE"
                    },
                    {
                    "name": "min",
                    "type": "DOUBLE"
                    }
                    ]
                    }
                </template>
                <template type="eventsink">
                    <![CDATA[
                <EventStoreConfiguration>
             <TableSchema>
            <ColumnDefinition>
                <Name>sensor_type</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>true</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>STRING</Type>
            </ColumnDefinition>
            <ColumnDefinition>
                <Name>sensor_id_distinct_count</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>LONG</Type>
            </ColumnDefinition>
            <ColumnDefinition>
                <Name>count</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>LONG</Type>
            </ColumnDefinition>
            <ColumnDefinition>
                <Name>sum</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>DOUBLE</Type>
            </ColumnDefinition>
            <ColumnDefinition>
                <Name>average</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>DOUBLE</Type>
            </ColumnDefinition>
            <ColumnDefinition>
                <Name>max</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>DOUBLE</Type>
                </ColumnDefinition>
            <ColumnDefinition>
                <Name>min</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>DOUBLE</Type>
            </ColumnDefinition>
           </TableSchema>
               <Source>
            <StreamId>org.wso2.event.${toId('$sensorType')}.statistics.stream:1.0.0</StreamId>
           </Source>
           <MergeSchema>false</MergeSchema>
           <RecordStoreName>EVENT_STORE</RecordStoreName>
         </EventStoreConfiguration>
                    ]]>
                </template>
                <template type="realtime">
                    <![CDATA[
                /* Enter a unique ExecutionPlan */
                @Plan:name('SensorAnalyticsPlan')

                /* Enter a unique description for ExecutionPlan */
                -- @Plan:description('ExecutionPlan')

                /* define streams/tables and write queries here ... */

                @Import('org.wso2.event.${toId('$sensorType')}.stream:1.0.0')
                define stream InputStream (sensor_id string, sensor_value double);

        @Export('org.wso2.event.${toId('$sensorType')}.statistics.stream:1.0.0')
        define stream OutputStream (sensor_type string, sensor_id_distinct_count long, count long, sum double, average double, max double, min double);

        from InputStream#window.time($timeInMins min)
        select '${toId('$sensorType')}' as sensor_type, distinctcount(sensor_id) as sensor_id_distinct_count, count() as count, sum(sensor_value) as sum, avg(sensor_value) as average, max(sensor_value) as           max, min(sensor_value) as min
        insert into OutputStream;
                    ]]>
                </template>
                <!--<template type="realTime">     &lt;!&ndash;Can define multiple Templates of same type. E.g. of type realTime, as shown here.&ndash;&gt;-->

                <!--</template>
                <template type="batch">

                </template>-->

                <!-- Average -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-average-chart</property>
                            <property name="templateDirectory">numberchart</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                                {"id":"${toId('$sensorType')}-average-chart","title":"Average $sensorType","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-average-chart/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-average-chart/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-average-chart","title":"Average $sensorType","datasource":"ORG_WSO2_EVENT_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_type","type":"string"},{"name":"sensor_id_distinct_count","type":"long"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"x":"average","maxLength":"","padding":{"top":30,"left":45,"bottom":38,"right":55},"charts":[{"type":"number","title":"Displays Average of $sensorType"}]},"domain":"carbon.super"};
                                ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>

                <!-- Count -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-count-chart</property>
                            <property name="templateDirectory">numberchart</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                                {"id":"${toId('$sensorType')}-count-chart","title":"Count $sensorType","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-average-chart/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-count-chart/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-count-chart","title":"Count $sensorType","datasource":"ORG_WSO2_EVENT_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_type","type":"string"},{"name":"sensor_id_distinct_count","type":"long"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"x":"count","maxLength":"","padding":{"top":30,"left":45,"bottom":38,"right":55},"charts":[{"type":"number","title":"Displays Count of $sensorType"}]},"domain":"carbon.super"};

                                ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>

                <!-- DistinctCount -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-distinctcount-chart</property>
                            <property name="templateDirectory">numberchart</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                                {"id":"${toId('$sensorType')}-distinctcount-chart","title":"Distinct Count $sensorType","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-distinctcount-chart/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-distinctcount-chart/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-distinctcount-chart","title":"Sensor ID Count $sensorType","datasource":"ORG_WSO2_EVENT_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_type","type":"string"},{"name":"sensor_id_distinct_count","type":"long"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"x":"sensor_id_distinct_count","maxLength":"","padding":{"top":30,"left":45,"bottom":38,"right":55},"charts":[{"type":"number","title":"Displays Sensor ID Distinct Count of $sensorType"}]},"domain":"carbon.super"};
                                ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>

                <!-- Max -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-max-chart</property>
                            <property name="templateDirectory">numberchart</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                                {"id":"${toId('$sensorType')}-max-chart","title":"Max $sensorType","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-max-chart/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-max-chart/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-max-chart","title":"Max $sensorType","datasource":"ORG_WSO2_EVENT_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_type","type":"string"},{"name":"sensor_id_distinct_count","type":"long"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"x":"max","maxLength":"","padding":{"top":30,"left":45,"bottom":38,"right":55},"charts":[{"type":"number","title":"Displays the maximum $sensorType"}]},"domain":"carbon.super"}
                                ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>

                <!-- Min -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-min-chart</property>
                            <property name="templateDirectory">numberchart</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                                {"id":"${toId('$sensorType')}-min-chart","title":"Min $sensorType","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-min-chart/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-min-chart/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-min-chart","title":"Min $sensorType","datasource":"ORG_WSO2_EVENT_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_type","type":"string"},{"name":"sensor_id_distinct_count","type":"long"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"x":"min","maxLength":"","padding":{"top":30,"left":45,"bottom":38,"right":55},"charts":[{"type":"number","title":"Displays the minimum of $sensorType"}]},"domain":"carbon.super"};

                                ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>

                <!-- Sum -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-sum-chart</property>
                            <property name="templateDirectory">numberchart</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                                {"id":"${toId('$sensorType')}-sum-chart","title":"Sum $sensorType","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-sum-chart/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-sum-chart/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-sum-chart","title":"Sum $sensorType","datasource":"ORG_WSO2_EVENT_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_type","type":"string"},{"name":"sensor_id_distinct_count","type":"long"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"x":"sum","maxLength":"","padding":{"top":30,"left":45,"bottom":38,"right":55},"charts":[{"type":"number","title":"Displays the sum of $sensorType"}]},"domain":"carbon.super"};
                                ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>

                <!-- Dashboard -->
                <template type="dashboard">
                    <config>
                        <properties>
                            <property name="dashboardId">analytics-${toId('$sensorType')}-dashboard</property>
                        </properties>
                        <content>
                            <![CDATA[
                    {
                        "accessTokenUrl": "",
                        "apiKey": "",
                        "apiSecret": "",
                        "banner": {
                            "customBannerExists": false,
                            "globalBannerExists": false
                        },
                        "defaultPriority": "5",
                        "description": "",
                        "hideAllMenuItems": false,
                        "id": "analytics-${toId('$sensorType')}-dashboard",
                        "identityServerUrl": "",
                        "isEditorEnable": true,
                        "isUserCustom": false,
                        "isanon": false,
                        "landing": "landing",
                        "menu": [
                            {
                                "id": "landing",
                                "isanon": false,
                                "ishidden": false,
                                "subordinates": [],
                                "title": "Home"
                            }
                        ],
                        "pages": [
                            {
                                "content": {
                                    "anon": {},
                                    "default": {
                                        "a": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-max-chart/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-max-chart",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "Max $sensorType"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-max-chart/gadgetIcon.png",
                                                    "title": "Max $sensorType",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-max-chart-0"
                                            }
                                        ],
                                        "b": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-sum-chart/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-sum-chart",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "Sum $sensorType"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-sum-chart/gadgetIcon.png",
                                                    "title": "Sum $sensorType",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-sum-chart-0"
                                            }
                                        ],
                                        "c": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-min-chart/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-min-chart",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "Min $sensorType"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-min-chart/gadgetIcon.png",
                                                    "title": "Min $sensorType",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-min-chart-0"
                                            }
                                        ],
                                        "d": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-average-chart/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-average-chart",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "Average $sensorType"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-average-chart/gadgetIcon.png",
                                                    "title": "Average $sensorType",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-average-chart-0"
                                            }
                                        ],
                                        "e": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-count-chart/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-count-chart",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "Count $sensorType"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-average-chart/gadgetIcon.png",
                                                    "title": "Count $sensorType",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-count-chart-0"
                                            }
                                        ],
                                        "f": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-distinctcount-chart/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-distinctcount-chart",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "Distinct Count $sensorType"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-distinctcount-chart/gadgetIcon.png",
                                                    "title": "Distinct Count $sensorType",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-distinctcount-chart-0"
                                            }
                                        ]
                                    }
                                },
                                "id": "landing",
                                "isanon": false,
                                "layout": {
                                    "content": {
                                        "loggedIn": {
                                            "blocks": [
                                                {
                                                    "height": 3,
                                                    "id": "a",
                                                    "width": 4,
                                                    "x": 0,
                                                    "y": 0
                                                },
                                                {
                                                    "height": 3,
                                                    "id": "b",
                                                    "width": 4,
                                                    "x": 4,
                                                    "y": 0
                                                },
                                                {
                                                    "height": 3,
                                                    "id": "c",
                                                    "width": 4,
                                                    "x": 8,
                                                    "y": 0
                                                },
                                                {
                                                    "height": 3,
                                                    "id": "d",
                                                    "width": 4,
                                                    "x": 0,
                                                    "y": 3
                                                },
                                                {
                                                    "height": 3,
                                                    "id": "e",
                                                    "width": 4,
                                                    "x": 4,
                                                    "y": 3
                                                },
                                                {
                                                    "height": 3,
                                                    "id": "f",
                                                    "width": 4,
                                                    "x": 8,
                                                    "y": 3
                                                }
                                            ]
                                        }
                                    },
                                    "fluidLayout": false
                                },
                                "title": "Home"
                            }
                        ],
                        "permissions": {
                            "editors": [
                                "Internal/everyone"
                            ],
                            "viewers": [
                                "Internal/everyone"
                            ]
                        },
                        "theme": "Default Theme",
                        "title": "Analytics $sensorType Dashboard"
                    }
                    ]]>
                        </content>
                    </config>
                </template>

            </templates>
            <streamMappings>
                <streamMapping to="org.wso2.event.${toId('$sensorType')}.stream:1.0.0"/>
            </streamMappings>
            <parameters>
                <parameter name="timeInMins" type="int">
                    <displayName>Time(Mins)</displayName>
                    <description> The sliding time period for which the window should hold events</description>
                    <defaultValue>1</defaultValue>
                </parameter>
                <parameter name="sensorType" type="string">
                    <displayName>Sensor Type Name</displayName>
                    <description>The name of the sensor type</description>
                    <defaultValue>Temperature</defaultValue>
                </parameter>
            </parameters>

        </scenario>
        <scenario type="GroupedSensorAnalytics">
            <description>Configure a sensor analytics scenario with grouped by sensor_id to display statistics for a given stream of your choice</description>
            <templates>
                <!--Note: These will be deployed in the order they appear here-->
                <template type="eventstream">
                    {
                    "name": "org.wso2.event.group.${toId('$sensorType')}.stream",
                    "version": "1.0.0",
                    "nickName": "",
                    "description": "",
                    "payloadData": [
                    {
                    "name": "sensor_id",
                    "type": "STRING"
                    },
                    {
                    "name": "sensor_value",
                    "type": "DOUBLE"
                    }
                    ]
                    }
                </template>
                <template type="eventstream">
                    {
                    "name": "org.wso2.event.grouped.${toId('$sensorType')}.statistics.stream",
                    "version": "1.0.0",
                    "nickName": "",
                    "description": "",
                    "payloadData": [
                    {
                    "name": "sensor_id",
                    "type": "STRING"
                    },
                    {
                    "name": "count",
                    "type": "LONG"
                    },
                    {
                    "name": "sum",
                    "type": "DOUBLE"
                    },
                    {
                    "name": "average",
                    "type": "DOUBLE"
                    },
                    {
                    "name": "max",
                    "type": "DOUBLE"
                    },
                    {
                    "name": "min",
                    "type": "DOUBLE"
                    }
                    ]
                    }
                </template>
                <template type="eventsink">
                    <![CDATA[
                <EventStoreConfiguration>
            <TableSchema>
                <ColumnDefinition>
                <Name>sensor_id</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>true</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>STRING</Type>
                </ColumnDefinition>
                <ColumnDefinition>
                <Name>count</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>LONG</Type>
                </ColumnDefinition>
                <ColumnDefinition>
                <Name>sum</Name><IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>DOUBLE</Type>
                </ColumnDefinition>
                <ColumnDefinition>
                <Name>average</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>DOUBLE</Type>
                 </ColumnDefinition>
                 <ColumnDefinition>
                <Name>max</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>DOUBLE</Type>
                 </ColumnDefinition>
                 <ColumnDefinition>
                <Name>min</Name>
                <IsFacet>false</IsFacet>
                <EnableIndexing>false</EnableIndexing>
                <IsPrimaryKey>false</IsPrimaryKey>
                <EnableScoreParam>false</EnableScoreParam>
                <Type>DOUBLE</Type>
                 </ColumnDefinition>
            </TableSchema>
            <Source><StreamId>org.wso2.event.grouped.${toId('$sensorType')}.statistics.stream:1.0.0</StreamId>
            </Source>
            <MergeSchema>false</MergeSchema>
            <RecordStoreName>EVENT_STORE</RecordStoreName>
        </EventStoreConfiguration>
                    ]]>
                </template>
                <template type="realtime">
                    <![CDATA[
                /* Enter a unique ExecutionPlan */
        @Plan:name('GroupSensorAnalyticsPlan')

        /* Enter a unique description for ExecutionPlan */
        -- @Plan:description('ExecutionPlan')

        /* define streams/tables and write queries here ... */

        @Import('org.wso2.event.group.${toId('$sensorType')}.stream:1.0.0')
        define stream InputStream (sensor_id string, sensor_value double);

        @Export('org.wso2.event.grouped.${toId('$sensorType')}.statistics.stream:1.0.0')
        define stream OutputStream (sensor_id string, count long, sum double, average double, max double, min double);

        from InputStream#window.time(1 min)
        select sensor_id, count() as count, sum(sensor_value) as sum, avg(sensor_value) as average, max(sensor_value) as max, min(sensor_value) as min
        group by sensor_id
        insert into OutputStream;
                    ]]>
                </template>

                <!-- Count Bar Chart -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-grouped-count</property>
                            <property name="templateDirectory">CountPerSensorId_BarChart</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                {"id":"${toId('$sensorType')}-grouped-count","title":"$sensorType Grouped Count","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-grouped-count/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-grouped-count/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-grouped-count","title":"$sensorType Grouped Count","datasource":"ORG_WSO2_EVENT_GROUPED_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_id","type":"string"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"x":"sensor_id","maxLength":"100","padding":{"top":30,"left":45,"bottom":38,"right":55},"charts":[{"type":"bar","y":"count"}]},"domain":"carbon.super"};
                                 ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>

                <!-- Count Donut Chart -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-compare-grouped-count</property>
                            <property name="templateDirectory">CountPerSensorId_DonutChart</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                {"id":"${toId('$sensorType')}-compare-grouped-count","title":"$sensorType Compare Grouped Count","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-grouped-count/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-compare-grouped-count/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-compare-grouped-count","title":"$sensorType Compared Grouped Count","datasource":"ORG_WSO2_EVENT_GROUPED_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_id","type":"string"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"x":"sensor_id","maxLength":"100","charts":[{type: "arc",  x : "count", color : "sensor_id", mode: "donut"}]},"domain":"carbon.super"};
             ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>

                <!-- Count Pie Chart -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-grouped-count-pie</property>
                            <property name="templateDirectory">CountPerSensorId_PieChart</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                {"id":"${toId('$sensorType')}-grouped-count-pie","title":"$sensorType Count in Pie","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-grouped-count-pie/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-grouped-count-pie/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-grouped-count-pie","title":"$sensorType Count in Pie","datasource":"ORG_WSO2_EVENT_GROUPED_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_id","type":"string"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"x":"sensor_id","maxLength":"100","charts":[{type: "arc",  x : "count", color : "sensor_id", mode: "pie"}]},"domain":"carbon.super"};
                                 ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>
                <!-- Count Table Chart -->
                <template type="gadget">
                    <config>
                        <properties>
                            <property name="directoryName">${toId('$sensorType')}-reading-table</property>
                            <property name="templateDirectory">TableViewPerSensorID</property>
                        </properties>
                        <artifacts>
                            <artifact file="gadget.json">
                                <![CDATA[
                {"id":"${toId('$sensorType')}-reading-table","title":"$sensorType Reading Table","type":"gadget","thumbnail":"gadget/${toId('$sensorType')}-reading-table/gadgetIcon.png","data":{"url":"gadget/${toId('$sensorType')}-reading-table/index.xml"}}
                                ]]>
                            </artifact>
                            <artifact file="js/gadgetconf.js">
                                <![CDATA[
                                var gadgetConfig ={"id":"${toId('$sensorType')}-reading-table","title":"$sensorType Reading Table","datasource":"ORG_WSO2_EVENT_GROUPED_${toId('$sensorType')}_STATISTICS_STREAM","type":"batch","columns":[{"name":"sensor_id","type":"string"},{"name":"count","type":"long"},{"name":"sum","type":"double"},{"name":"average","type":"double"},{"name":"max","type":"double"},{"name":"min","type":"double"}],"chartConfig":{"chartType":"tabular","charts":[{"type":"table","key":"sensor_id","padding":{"top":30,"left":45,"bottom":38,"right":55},"color":"-1","columns":["sensor_id","count","sum","average","max","min"],"columnTitles":["sensor_id","count","sum","average","max","min"]}]},"domain":"carbon.super"};
                                 ]]>
                            </artifact>
                        </artifacts>
                    </config>
                </template>

                <!-- Dashboard -->
                <template type="dashboard">
                    <config>
                        <properties>
                            <property name="dashboardId">grouped-${toId('$sensorType')}-dashboard</property>
                        </properties>
                        <content>
                            <![CDATA[
                    {
                        "accessTokenUrl": "",
                        "apiKey": "",
                        "apiSecret": "",
                        "banner": {
                            "customBannerExists": false,
                            "globalBannerExists": false
                        },
                        "defaultPriority": "5",
                        "description": "",
                        "hideAllMenuItems": false,
                        "id": "grouped-${toId('$sensorType')}-dashboard",
                        "identityServerUrl": "",
                        "isEditorEnable": true,
                        "isUserCustom": false,
                        "isanon": false,
                        "landing": "landing",
                        "menu": [
                            {
                                "id": "landing",
                                "isanon": false,
                                "ishidden": false,
                                "subordinates": [],
                                "title": "Home"
                            }
                        ],
                        "pages": [
                            {
                                "content": {
                                    "anon": {},
                                    "default": {
                                        "a": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-compare-grouped-count/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-compare-grouped-count",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "$sensorType Compare Grouped Count"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-compare-grouped-count/gadgetIcon.png",
                                                    "title": "$sensorType Compare Grouped Count",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-compare-grouped-count-0"
                                            }
                                        ],
                                        "b": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-grouped-count/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-grouped-count",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "$sensorType Grouped Count"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-grouped-count/gadgetIcon.png",
                                                    "title": "$sensorType Grouped Count",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-grouped-count-0"
                                            }
                                        ],
                                        "c": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-grouped-count-pie/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-grouped-count-pie",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "$sensorType Count in Pie"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-grouped-count-pie/gadgetIcon.png",
                                                    "title": "$sensorType Count in Pie",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-grouped-count-pie-0"
                                            }
                                        ],
                                        "d": [
                                            {
                                                "content": {
                                                    "data": {
                                                        "url": "fs://gadget/${toId('$sensorType')}-reading-table/index.xml"
                                                    },
                                                    "id": "${toId('$sensorType')}-reading-table",
                                                    "locale_titles": {},
                                                    "options": {
                                                        "dataSource": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Data Source",
                                                            "type": "STRING",
                                                            "value": "/portal/gadgets/bar-chart/datasource/dataFile4.jag"
                                                        },
                                                        "updateGraph": {
                                                            "options": [],
                                                            "required": false,
                                                            "title": "Update Interval (s)",
                                                            "type": "STRING",
                                                            "value": "No"
                                                        }
                                                    },
                                                    "styles": {
                                                        "borders": true,
                                                        "title": "$sensorType Reading Table"
                                                    },
                                                    "thumbnail": "fs://gadget/${toId('$sensorType')}-reading-table/gadgetIcon.png",
                                                    "title": "$sensorType Reading Table",
                                                    "type": "gadget"
                                                },
                                                "id": "${toId('$sensorType')}-reading-table-0"
                                            }
                                        ]
                                    }
                                },
                                "id": "landing",
                                "isanon": false,
                                "layout": {
                                    "content": {
                                        "loggedIn": {
                                            "blocks": [
                                                {
                                                    "banner": false,
                                                    "height": 3,
                                                    "id": "a",
                                                    "width": 4,
                                                    "x": 0,
                                                    "y": 0
                                                },
                                                {
                                                    "banner": false,
                                                    "height": 3,
                                                    "id": "b",
                                                    "width": 4,
                                                    "x": 4,
                                                    "y": 0
                                                },
                                                {
                                                    "banner": false,
                                                    "height": 3,
                                                    "id": "c",
                                                    "width": 4,
                                                    "x": 8,
                                                    "y": 0
                                                },
                                                {
                                                    "banner": false,
                                                    "height": 5,
                                                    "id": "d",
                                                    "width": 12,
                                                    "x": 0,
                                                    "y": 3
                                                }
                                            ]
                                        }
                                    },
                                    "fluidLayout": false
                                },
                                "title": "Home"
                            }
                        ],
                        "permissions": {
                            "editors": [
                                "Internal/everyone"
                            ],
                            "viewers": [
                                "Internal/everyone"
                            ]
                        },
                        "theme": "Default Theme",
                        "title": "Grouped $sensorType Dashboard"
                    }
                    ]]>
                        </content>
                    </config>
                </template>

            </templates>
            <streamMappings>
                <streamMapping to="org.wso2.event.group.${toId('$sensorType')}.stream:1.0.0"/>
            </streamMappings>
            <parameters>
                <parameter name="timeInMins" type="int">
                    <displayName>Time (Mins)</displayName>
                    <description> The sliding time period for which the window should hold events</description>
                    <defaultValue>1</defaultValue>
                </parameter>
                <parameter name="sensorType" type="string">
                    <displayName>Sensor Type Name</displayName>
                    <description>The name of the sensor type</description>
                    <defaultValue>Temperature</defaultValue>
                </parameter>
            </parameters>

        </scenario>
    </scenarios>

    <scripts>
        <script src="wso2-commons.js"/>
    </scripts>
</domain>